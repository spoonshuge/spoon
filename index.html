<!DOCTYPE html>
<html>
  <head>
    <meta charset="UTF-8">
    <title>Write to Google Sheet V0.2</title>
  </head>
  <body>
    <h1>Send input to your Sheet</h1>

    <form id="inputForm">
      <input
        type="text"
        id="textInput"
        placeholder="Enter something…"
        required
      />
      <button type="submit">Submit</button>
    </form>

    <p id="responseMessage"></p>

    <script>
      const SCRIPT_URL = 'https://script.google.com/macros/s/AKfycbxOgTeA40jGqZfgcgLSfJxVkNmt33We6Hu6Qy_7v3hxq5zmEV2cGt9_ofGRju4cdP41/exec';
      const form     = document.getElementById('inputForm');
      const inputEl  = document.getElementById('textInput');
      const outputEl = document.getElementById('responseMessage');

      form.addEventListener('submit', e => {
        e.preventDefault();
        const val = encodeURIComponent(inputEl.value.trim());
        fetch(`${SCRIPT_URL}?input=${val}`)
          .then(r => r.json())
          .then(data => {
            outputEl.textContent = data.message;
            inputEl.value = '';
          })
          .catch(err => outputEl.textContent = '❌ Error: '+err.message);
      });
    </script>
  </body>
</html>
